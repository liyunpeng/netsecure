###  go.modçš„module ç¡®å®šäº†æœ¬åœ°æŠ¥å
go.mod é‡Œçš„

module github.com/filecoin-project/lotus

ç¡®å®šäº†æ¯ä¸ªå¼•å…¥çš„åŒ…åï¼š
![-w1345](media/15961635283518.jpg)

### è°ƒè¯•

#### module é…ç½®
Evnviromentä¿æŒä¸ºç©º
![-w1006](media/15961763105125.jpg)


#### ä¸è¦go mod vendor
å¯ä»¥go mod init , go mod tidy, ä½†ä¸è¦go mod vendor, å¦åˆ™å¼•èµ·ä»£ç æ‹·è´ï¼Œ ç¼–è¯‘é”™è¯¯ã€‚ 
ä¸ç”¨go mod vendor, ç¬¬ä¸‰æ–¹ä»£ç æ”¾åˆ°exeternal librariesé‡Œï¼Œ å¯ä»¥ä»£ç é“¾æ¥ï¼Œ ä¸ä¼šçº¢è‰²ï¼š
![-w1388](media/15961761909899.jpg)


#### é…ç½®ç¼–è¯‘ go build 
![-w1076](media/15961760538333.jpg)

#### lotusä¸é€šä¸»è¦æ–­ç‚¹ä½ç½®
![-w1068](media/15961765964854.jpg)


### rpcé”™è¯¯

lotus.log é‡Œçš„rpcé”™è¯¯ï¼š

```
2020-07-31T13:56:23.320+0800    INFO    hello   hello/hello.go:179      time offset     {"offset": 0.000003, "peerid": "QmWNqm66Hj9eqYpBfaxiPWGb5oRr6Bowfof4sD7nyLBW2d"}



2020-07-31T14:21:55.924+0800    INFO    pubsub  go-libp2p-pubsub@v0.3.2/comm.go:51      error reading rpc from QmVSd1Xv2rPUzn59GV6Nz7qt8aQx1EUPViUFK5N6Foh2Ni: stream reset

```

### lotus.log è®¾ç½®logç­‰çº§

![-w676](media/15961798436302.jpg)


### stream reset
ä¸€æ¬¡é“¾æ¥æ–­äº†ï¼Œ ä¸‹æ¬¡å°±ä¸èƒ½ç”¨äº†
![-w1053](media/15961799439610.jpg)


#### ç”³è¯·é’±ç”³è¯·ä¸åˆ°
![-w1834](media/15961801247850.jpg)


#### æ²¡æœ‰é’±å¯¼è‡´æ¶ˆæ¯å‘ä¸å‡ºå»
æŸ¥çœ‹æ¶ˆæ¯ï¼š
./lotus mpool pending
æ¶ˆæ¯çš„nonceå€¼

åˆ°å…¶ä»–èŠ‚ç‚¹çœ‹t3ï¼š
./lotus state get-actor t3uqjah7mo5wgtuq2qcgm2rowlk33yq3a5kwp5jqnqcwaf6ldz7dgjdjwkupkj24sxz73vk5yfpg5tub32qfna

#### ç®—åŠ›æ¢å¤
æ—¶é—´åˆ°äº†ï¼Œ 
æ˜¨å¤©è¿™ä¸ªæ—¶é—´æƒ©ç½šäº†ï¼Œ ç„¶åæŠŠè¿™äº›sectoræ•´å¥½ï¼Œæˆ–ä»€ä¹ˆå…¶ä»–æ“ä½œï¼Œ ä»Šå¤©åŒä¸€æ—¶é—´ï¼Œ ä¼šé‡æ–°è¯æ˜ï¼Œ æ‰€ä»¥ç®—åŠ›ä¼šæ¢å¤ï¼Œ æ‰€ä»¥åªæœ‰åœ¨é‡æ–°è¯æ˜çš„æ—¶å€™ï¼Œ æ‰ä¼šæ¢å¤ç®—åŠ›ã€‚ 


#### æ°´é¾™å¤´é—®é¢˜
![-w1788](media/15961813939103.jpg)


#### lotus

æœ€æ–°åˆ†æ”¯æœ‰lotusè¿è¡Œä¸­æ”¹å˜bootstrap blacklistå’Œwhitelistçš„å‘½ä»¤ï¼Œå’Œnet å·®ä¸å¤šï¼Œä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶ä¸ä¼šè®°å½•åœ¨æ–‡ä»¶ï¼Œé‡å¯åéœ€è¦é‡æ–°é…ç½®ï¼Œå‘½ä»¤å‚è€ƒï¼š ./lotus peermgr -hï¼ŒCOMMANDS:
```
blacklist  Print peers blacklist
blremove   Remove peer from blacklist
bladd      Add peer to blacklist
whitelist  Print peers whitelist
wlremove   Remove peer from whitelist
wladd      Add peer to whitelist
reconn     Reconn peer
```
   
#### lotus æ”¶åˆ°çš„æ¶ˆæ¯çš„æµç¨‹
![-w1887](media/15961850297994.jpg)
makeminer 
ä¸€ä¸ªPeerç»ƒåˆ°ä¸€ä¸ªlotusèŠ‚ç‚¹æ—¶ï¼Œ lotusèŠ‚ç‚¹çš„æµç¨‹ï¼š

1 basic_host.go æ‹¨é€šè¿æ¥QmTd6UvR47vUidRNZ1ZKXHrAFhqTJAD27rKL9XYghEKgKX
```
basichost       basic/basic_host.go:702 host 12D3KooWGtsbzpxi94t7jPvjWGXTiH1AHZuSpRp9Dyqa9TnVPu1z dialing QmTd6UvR47vUidRNZ1ZKXHrAFhqTJAD27rKL9XYghEKgKX

swarm2  go-libp2p-swarm@v0.2.7/swarm_dial.go:240        [12D3KooWGtsbzpxi94t7jPvjWGXTiH1AHZuSpRp9Dyqa9TnVPu1z] swarm dialing peer [QmTd6UvR47vUidRNZ1ZKXHrAFhqTJAD27rKL9XYghEKgKX]
```

2  è¿æ¥å»ºç«‹
```
 network for 12D3KooWGtsbzpxi94t7jPvjWGXTiH1AHZuSpRp9Dyqa9TnVPu1z finished diali
```

3  èº«ä»½æ¶ˆæ¯æ”¶å‘
```
net/identify    identify/id.go:407      /ipfs/id/1.0.0 sent message to QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw /ip4/192.168.12.2/tcp/9000
net/identify    identify/id.go:424      /ipfs/id/1.0.0 received message from QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw /ip4/192.168.12.2/tcp/9000
net/identify    identify/id.go:618      12D3KooWGtsbzpxi94t7jPvjWGXTiH1AHZuSpRp9Dyqa9TnVPu1z received listen addrs for QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw: [/ip4/192.168.12.2/tcp/9000]
```

4 add peer
```
pubsub	go-libp2p-pubsub@v0.3.2/gossipsub.go:442	PEERUP: Add new peer QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw using /meshsub/1.1.0
swarm2	go-libp2p-swarm@v0.2.7/swarm.go:321	[12D3KooWGtsbzpxi94t7jPvjWGXTiH1AHZuSpRp9Dyqa9TnVPu1z] opening stream to peer [QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw]
dht	go-libp2p-kad-dht@v0.8.1/dht.go:607	peer stopped dht	{"peer": "QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw"}
```


5 ç»™peerå‘é€helloæ¶ˆæ¯
```
hello	hello/hello.go:149	Sending hello message: [bafy2bzacedm25s7nmp4forvpbian3ik36uv4yik2fe7tqzgv6z6xystmi3i5q] 0 bafy2bzacedm25s7nmp4forvpbian3ik36uv4yik2fe7tqzgv6z6xystmi3i5q
543+0800	[34mINFO[0m	hello	hello/hello.go:179	time offset	{"offset": -0.0001955, "peerid": "QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw"}
```

6 genesis from hello
```
hello	hello/hello.go:74	genesis from hello	{"tipset": [{"/":"bafy2bzacedm25s7nmp4forvpbian3ik36uv4yik2fe7tqzgv6z6xystmi3i5q"}], "peer": "QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw", "hash": "bafy2bzacedm25s7nmp4forvpbian3ik36uv4yik2fe7tqzgv6z6xystmi3i5q"}
```

7 å°†æ¶ˆæ¯ä»networkåŠ å…¥åˆ°æ¶ˆæ¯æ± 
```
sub	sub/incoming.go:407	failed to add message from network to message pool (From: t3qpbkej2ypyuc7qjxxqb3ikujelnd6cifbj4rmiupfr7xwllu4b4ewlidgvnkt5fshsdy447t674cvjt7sxea, To: t04, Nonce: 1, Value: 0 FIL): failed to look up actor state nonce: get actor: resolution lookup failed (t3qpbkej2ypyuc7qjxxqb3ikujelnd6cifbj4rmiupfr7xwllu4b4ewlidgvnkt5fshsdy447t674cvjt7sxea): resolve address t3qpbkej2ypyuc7qjxxqb3ikujelnd6cifbj4rmiupfr7xwllu4b4ewlidgvnkt5fshsdy447t674cvjt7sxea: address not found: broadcasting message despite validation fail
```

ä»¥ä¸Šçš„logçš„æ„æ€æ˜¯ï¼šå¾…éªŒè¯æ¶ˆæ¯çš„fromåœ¨é“¾ä¸Šæ‰¾ä¸åˆ°ï¼Œ æ‰€ä»¥è¿™ä¸ªæ¶ˆæ¯éªŒè¯å¤±è´¥ï¼Œä¸èƒ½è¿›å…¥mpoolã€‚
    
```
pubsub	go-libp2p-pubsub@v0.3.2/validation.go:340	message validation punted; ignoring message from QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNw
```

æ¶ˆæ¯éªŒè¯å¤±è´¥äº†ï¼Œ å¿½ç•¥å‘è¿™ä¸ªæ¶ˆæ¯çš„ peerï¼š QmZEVcmCf9A9bfoNvM1Wb2o1J8eRjHCGuCNzxSp4LRFgNwå‘æ¥çš„æ¶ˆæ¯


#### peer ä¸lotus ç©ºèŠ‚ç‚¹çš„è¿æ¥
å› ä¸ºmakeminer è¿™ä¸ªpeerçš„getNetName(), å¾—åˆ°çš„æ˜¯å…¬ç½‘çš„nameï¼Œ lotusç©ºèŠ‚ç‚¹çš„nameä¸æ˜¯å…¬ç½‘ï¼Œ æ‰€ä»¥è¿™ä¸ªpeerå»è¿lotusæ—¶ï¼Œ ä¼šæœ‰ä¸ªçŸ­æš‚çš„è¿æ¥ï¼Œ éšåï¼Œå› ä¸ºnameé”™è¯¯åŸå› ï¼Œ åˆä¼šæ–­å¼€ï¼š
å› ä¸ºå®˜æ–¹ä»£ç ï¼Œ æ²¡æœ‰è¿æ¥æˆåŠŸçš„å‡½æ•°å›è°ƒï¼Œ
![-w747](media/15961897714619.jpg)
 æ‰€ä»¥å®˜æ–¹ç‰ˆæœ¬æ²¡æœ‰è¿™ä¸ªpeerä¸lotusè¿æ¥æˆåŠŸçš„log. 
 