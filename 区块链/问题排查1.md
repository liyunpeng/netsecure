### sector 长期处于commiting状态
sector  表知道到问题sectorid -> 到tasks表， 按这个sectorid找到task, 确定worker在那个ip节点, 然后看sealer, 因为sealer和p1放在一起， 去sealer, 看这个Sectorid。 

```
[root@yangzhou010010012001 ~]# ./lotus-storage-miner  sectors list| grep 16692481
```

结果为空， 说明被重置。

```
[root@yangzhou010010012001 log]# cat sealer.log | grep -a 16692481 | grep -v status
2020-06-23T12:02:39.807+0800	INFO	serverapi	serverapi/serverapi.go:231	NewSectorInfo:{"code":0,"msg":"","data":{"sectorID":16692481,"storageNodeID":71,"loc":"nfs/10.10.13.1"}}
2020-06-23T12:02:39.808+0800	INFO	remote-sealer	remote/sealer.go:279	generate new sector {16692481} ...
2020-06-23T12:02:39.821+0800	INFO	sectors	ffsm/garbage.go:25	Pledge {1007 16692481}, contains []
2020-06-23T12:02:39.821+0800	INFO	sectors	ffsm/sealing.go:159	Start sealing 16692481
2020-06-23T12:02:39.824+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: Packing ...
2020-06-23T12:02:39.830+0800	INFO	sectors	ffsm/states.go:19	performing filling up rest of the sector...	{"sector": "16692481"}
2020-06-23T12:02:39.830+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit1 ...
2020-06-23T12:02:39.837+0800	INFO	sectors	ffsm/states.go:94	performing sector replication...	{"sector": "16692481"}
2020-06-23T12:02:39.838+0800	DPANIC	sectors	zap@v1.15.0/sugar.go:179	Ignored key without a value.	{"ignored": "16692481"}
2020-06-23T12:02:39.844+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit1 ...
2020-06-23T12:02:39.850+0800	INFO	sectors	ffsm/states.go:94	performing sector replication...	{"sector": "16692481"}
2020-06-23T12:02:39.851+0800	INFO	remote-sealer	remote/sealer.go:408	PreCommitPhase1 for sector 16692481 start ...
2020-06-23T12:12:09.872+0800	INFO	remote-sealer	remote/sealer.go:987	PreCommitPhase1 for sector 16692481 elapsed 9m30.020676518s
2020-06-23T12:12:09.872+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit2 ...
2020-06-23T12:12:09.895+0800	INFO	remote-sealer	remote/sealer.go:528	PreCommitPhase2 for sector 16692481 start ...
2020-06-23T12:14:09.913+0800	INFO	remote-sealer	remote/sealer.go:987	PreCommitPhase2 for sector 16692481 elapsed 2m0.017911886s
2020-06-23T12:14:09.913+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommitting ...
2020-06-23T12:14:09.965+0800	INFO	sectors	ffsm/states.go:182	submitting precommit for sector: 16692481
2020-06-23T12:14:09.995+0800	INFO	sectors	ffsm/states.go:188	PreCommitSector msg for sector 16692481: bafy2bzaceavs77ywwdpbjjulyggvmnhzinvplxgsdeyhtahxgoa4fdwttpk4q
2020-06-23T12:14:09.995+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommitWait ...
2020-06-23T12:14:10.004+0800	INFO	sectors	ffsm/states.go:195	Sector precommitted: 16692481
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/states.go:201	wait PreCommitSector msg for sector 16692481: bafy2bzaceavs77ywwdpbjjulyggvmnhzinvplxgsdeyhtahxgoa4fdwttpk4q
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/states.go:208	precommit message landed on chain: 16692481
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: WaitSeed ...
2020-06-23T12:20:58.163+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: Committing ...
2020-06-23T12:20:58.219+0800	INFO	sectors	ffsm/states.go:252	KOMIT 16692481 5bf8499ee757de27aeea98cb7f353b686eb7241050f160c0dcb36182badd27bf(1116); d68cd8411aee52218add1c0aeb525c23276ba191573532412e6b7b85bdcdfa6f(2054); [{536870912 bafk4chzahfla46ytve5qpisd7utsb75hzm7b2lsqlkzwfhtz6rrrgujm3ida}]; r:6261666b3465687a61667a62723635746b35377334377063676d3361646e6e6c78337a3575667174646b717332676e6f646a633764686a786c36666b71; d:6261666b3463687a6168666c6134367974766535717069736437757473623735687a6d3762326c73716c6b7a776668747a3672727267756a6d33696461
2020-06-23T12:20:58.219+0800	INFO	remote-sealer	remote/sealer.go:617	CommitPhase1 for sector 16692481 start ...
```


搜索出最开始的10个sector. 
```
[root@yangzhou010010012001 ~]# ./lotus-storage-miner  sectors list| head -n10
16692553: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1624  seedH: 2551  deals: [0]
16692554: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1625  seedH: 2552  deals: [0]
16692555: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1626  seedH: 2554  deals: [0]
16692556: SealPreCommit2Failed sSet: NO  pSet: NO  tktH: 1627  seedH: 0     deals: [0]
16692557: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1629  seedH: 2557  deals: [0]
16692558: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1630  seedH: 2559  deals: [0]
16692559: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1631  seedH: 2560  deals: [0]
16692560: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1633  seedH: 2562  deals: [0]
16692561: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1634  seedH: 2562  deals: [0]
16692562: ComputeProofFailed   sSet: NO  pSet: NO  tktH: 1635  seedH: 2562  deals: [0]
```

有问题的sector的id为16692481， 但链的开始的sector的id为16692553， 说明这个链被重置了， 
.lotusstorage/datastore 存放了所有任务的id, 重置指的是删除.lotusstorage/datastore 这个文件夹。   虽然重置了， 但在 sealer.log里面还能找到这个sectorid.  但sector list

```
[root@yangzhou010010012001 ~]# cd .lotusstorage/
[root@yangzhou010010012001 .lotusstorage]# ls
api  cache  config.toml  datastore  keystore  repo.lock  sealed  sectorstore.json  serverapi  storage.json  token  unsealed
[root@yangzhou01001
```


查看一个sector的所有阶段性关键log， 因为status有大量重复， 反过滤掉。 
```
[root@yangzhou010010012001 log]# cat sealer.log | grep -a 16692481 | grep -v status
2020-06-23T12:02:39.807+0800	INFO	serverapi	serverapi/serverapi.go:231	NewSectorInfo:{"code":0,"msg":"","data":{"sectorID":16692481,"storageNodeID":71,"loc":"nfs/10.10.13.1"}}
2020-06-23T12:02:39.808+0800	INFO	remote-sealer	remote/sealer.go:279	generate new sector {16692481} ...
2020-06-23T12:02:39.821+0800	INFO	sectors	ffsm/garbage.go:25	Pledge {1007 16692481}, contains []
2020-06-23T12:02:39.821+0800	INFO	sectors	ffsm/sealing.go:159	Start sealing 16692481
2020-06-23T12:02:39.824+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: Packing ...
2020-06-23T12:02:39.830+0800	INFO	sectors	ffsm/states.go:19	performing filling up rest of the sector...	{"sector": "16692481"}
2020-06-23T12:02:39.830+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit1 ...
2020-06-23T12:02:39.837+0800	INFO	sectors	ffsm/states.go:94	performing sector replication...	{"sector": "16692481"}
2020-06-23T12:02:39.838+0800	DPANIC	sectors	zap@v1.15.0/sugar.go:179	Ignored key without a value.	{"ignored": "16692481"}
2020-06-23T12:02:39.844+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit1 ...
2020-06-23T12:02:39.850+0800	INFO	sectors	ffsm/states.go:94	performing sector replication...	{"sector": "16692481"}
2020-06-23T12:02:39.851+0800	INFO	remote-sealer	remote/sealer.go:408	PreCommitPhase1 for sector 16692481 start ...
2020-06-23T12:12:09.872+0800	INFO	remote-sealer	remote/sealer.go:987	PreCommitPhase1 for sector 16692481 elapsed 9m30.020676518s
2020-06-23T12:12:09.872+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommit2 ...
2020-06-23T12:12:09.895+0800	INFO	remote-sealer	remote/sealer.go:528	PreCommitPhase2 for sector 16692481 start ...
2020-06-23T12:14:09.913+0800	INFO	remote-sealer	remote/sealer.go:987	PreCommitPhase2 for sector 16692481 elapsed 2m0.017911886s
2020-06-23T12:14:09.913+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommitting ...
2020-06-23T12:14:09.965+0800	INFO	sectors	ffsm/states.go:182	submitting precommit for sector: 16692481
2020-06-23T12:14:09.995+0800	INFO	sectors	ffsm/states.go:188	PreCommitSector msg for sector 16692481: bafy2bzaceavs77ywwdpbjjulyggvmnhzinvplxgsdeyhtahxgoa4fdwttpk4q
2020-06-23T12:14:09.995+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: PreCommitWait ...
2020-06-23T12:14:10.004+0800	INFO	sectors	ffsm/states.go:195	Sector precommitted: 16692481
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/states.go:201	wait PreCommitSector msg for sector 16692481: bafy2bzaceavs77ywwdpbjjulyggvmnhzinvplxgsdeyhtahxgoa4fdwttpk4q
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/states.go:208	precommit message landed on chain: 16692481
2020-06-23T12:16:48.232+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: WaitSeed ...
2020-06-23T12:20:58.163+0800	INFO	sectors	ffsm/fsm.go:196	Sector 16692481 update state: Committing ...
2020-06-23T12:20:58.219+0800	INFO	sectors	ffsm/states.go:252	KOMIT 16692481 5bf8499ee757de27aeea98cb7f353b686eb7241050f160c0dcb36182badd27bf(1116); d68cd8411aee52218add1c0aeb525c23276ba191573532412e6b7b85bdcdfa6f(2054); [{536870912 bafk4chzahfla46ytve5qpisd7utsb75hzm7b2lsqlkzwfhtz6rrrgujm3ida}]; r:6261666b3465687a61667a62723635746b35377334377063676d3361646e6e6c78337a3575667174646b717332676e6f646a633764686a786c36666b71; d:6261666b3463687a6168666c6134367974766535717069736437757473623735687a6d3762326c73716c6b7a776668747a3672727267756a6d33696461
2020-06-23T12:20:58.219+0800	INFO	remote-sealer	remote/sealer.go:617	CommitPhase1 for sector 16692481 start ...
```
